	PROGRAM LINETHERM
	DIMENSION X(200),P(200),H(200),T(200)
	DATA U,AL,EDA0,RO,C,AJ,H1,H2/1.0,0.01,0.05,890.0,1870.0,4.184,5.5E-6,5.E-6/
	OPEN(8,FILE='OUT.DAT',STATUS='UNKNOWN')
	N=129
	A=U*AL*EDA0/2.0/AJ/RO/C/H2**2
	T0=303.0/A
	DX=1./(N-1.0)
	HH=H1/H2
	DH=HH-1.0
	DO I=1,N
	X(I)=(I-1)*DX
	H(I)=HH-DH*X(I)
	P(I)=-(-1.0/(H(I))+HH/(HH+1.0)/H(I)**2+1.0/(HH+1.0))/DH
	T(I)=T0
	ENDDO
	P(1)=0.0
	P(N)=0.0
	CALL THERM(N,A,DX,T0,X,P,H,T)
	CALL OUTPUT(N,A,T0,X,H,P,T)
	STOP
	END
	SUBROUTINE THERM(N,A,DX,T0,X,P,H,T)
	DIMENSION X(N),P(N),H(N),T(N)
10	ERT=0.0
	DO I=2,N
	TOLD=T(I)
	EDA=EXP(-0.03*A*(T(I)-T0))
	QX=0.5*H(I)-0.5*H(I)**3*((P(I)-P(I-1))/DX)
	T(I)=T(I-1)+DX*(2.0*EDA/H(I)+6.0*H(I)/EDA*((P(I)-P(I-1))/DX)**2)/QX
	T(I)=0.5*(TOLD+T(I))
	ERT=ERT+ABS(T(I)-TOLD)
	ENDDO
	ERT=A*ERT/(303.0*(N-1))
	WRITE(*,*)ERT
	IF(ERT.GT.1.E-6)GOTO 10
	RETURN
	END
	SUBROUTINE OUTPUT(N,A,T0,X,H,P,T)
	DIMENSION X(N),H(N),P(N),T(N)
	DO I=1,N
	T(I)=A*(T(I)-T0)
	END DO
	DO I=1,N
	WRITE(8,30)X(I),H(I),P(I),T(I)
	ENDDO
30  FORMAT(4(1X,E12.6))
	RETURN
	END
