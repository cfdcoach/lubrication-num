	SUBROUTINE VI(N,DX,P,V)
	DIMENSION P(N,N),V(N,N)
	COMMON /COMAK/AK(0:65,0:65)
	PAI1=0.2026423
	DO 40 I=1,N
	DO 40 J=1,N
	H0=0.0
	DO 30 K=1,N
	IK=IABS(I-K)
	DO 30 L=1,N
	JL=IABS(J-L)
30	H0=H0+AK(IK,JL)*P(K,L)
40	V(I,J)=H0*DX*PAI1
	RETURN
	END
	SUBROUTINE SUBAK(MM)
	COMMON /COMAK/AK(0:65,0:65)
	S(X,Y)=X+SQRT(X**2+Y**2)
	DO 10 I=0,MM
	XP=I+0.5
	XM=I-0.5
	DO 10 J=0,I
	YP=J+0.5
	YM=J-0.5
	A1=S(YP,XP)/S(YM,XP)
	A2=S(XM,YM)/S(XP,YM)
	A3=S(YM,XM)/S(YP,XM)
	A4=S(XP,YP)/S(XM,YP)
	AK(I,J)=XP*ALOG(A1)+YM*ALOG(A2)+XM*ALOG(A3)+YP*ALOG(A4)
10	AK(J,I)=AK(I,J)
	RETURN
	END
