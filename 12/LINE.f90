	DIMENSION P(1000),H0(1000),H(1000),V(1000),X(1000)
    OPEN (8,FILE='DATA.DAT',STATUS='UNKNOWN')
	N=129
	X1=1.4
	X0=-4.0
	DX=(X1-X0)/(N-1.0)
	DO I=1,N
	X(I)=-4.0+(I-1)*DX
	H0(I)=0.5*X(I)*X(I)
	H(I)=H0(I)
	P(I)=0.0
	IF(X(I).GE.-1.0.AND.X(I).LE.1.0)THEN
	P(I)=SQRT(1-X(I)*X(I))
	ENDIF
	ENDDO
	CALL SUBAK(N)
	CALL VI(N,DX,P,V)
	DO I=1,N
	H(I)=H(I)+V(I)
	WRITE(*,*)X(I),P(I),V(I),H0(I),H(I)
	WRITE(8,*)X(I),P(I),V(I),H0(I),H(I)
	ENDDO
	STOP
	END
	SUBROUTINE VI(N,DX,P,V)
	DIMENSION P(N),V(N)
	COMMON /COMAK/AK(0:1100)
	PAI1=0.318309886
	C=ALOG(DX)
	DO 10 I=1,N
	V(I)=0.0
	DO 10 J=1,N
	IJ=IABS(I-J)
10	V(I)=V(I)+(AK(IJ)+C)*DX*P(J)
	DO I=1,N
	V(I)=-PAI1*V(I)
	ENDDO
	RETURN
	END
	SUBROUTINE SUBAK(MM)
	COMMON /COMAK/AK(0:1100)
	DO 10 I=0,MM
10      AK(I)=(I+0.5)*(ALOG(ABS(I+0.5))-1.)-(I-0.5)*(ALOG(ABS(I-0.5))-1.)
	RETURN
	END

