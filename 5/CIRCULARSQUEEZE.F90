	PROGRAM CIRCULARSQUEEZE
	DIMENSION X(121),P(121),PD(121),W(101),V1(101),T(101),H1(101)
	DATA N,N1,N2,N3,EDA,H0,PI,R,SUM0,V/121,120,101,100,0.02,0.05,3.14159265,15.0,1000.0,-0.804146E-01/
	OPEN(8,FILE='RESULT.DAT',STATUS='UNKNOWN')
	OPEN(9,FILE='LOAD.DAT',STATUS='UNKNOWN')
	WRITE(*,*)'LD=0 挤压过程计算；LD=1 挤压瞬时压力分布与载荷计算?'
	READ(*,*)LD
	DX=1.0/N1
    PI2=2.0*PI
    S=PI*R**2/1000000.0
	V=V/R
	H0=H0/R
	DO I=1,N
	X(I)=(I-1)*DX	
	ENDDO		
	DO I=1,N
	P(I)=0.0
	ENDDO
	IF(LD.EQ.1)THEN
	SUM0=0.0
	GOTO 70
	ELSE
    GOTO 50
	ENDIF    
50  U=PI2/100.0
	DO I=1,N2
	W(I)=SUM0*(1.0+SIN(U*(I-1)))
	ENDDO
	H1(1)=H0
	DO K=1,N3        
	V=-1.0
	V=V/R
	DT=0.001
	CALL SUBP 
	CALL SUBM    
	ALENDA=12.0*EDA
	SUM1=ALENDA*S*SUM1	 
	V1(K)=W(K)*V/SUM1	 
	H1(K+1)=H1(K)+V1(K)*DT 
	H0=H1(K+1)
	ENDDO
	H0=H1(N2)
	V=-1.0
	V=V/R	
	CALL SUBP  
	CALL SUBM  
	ALENDA=12.0*EDA
	SUM1=ALENDA*S*SUM1
	V1(N2)=W(N2)*V/SUM1
	WRITE(8,"('时间T 载荷W 膜厚H 挤压速度V')")
	DO I=1,N2	 
	WRITE(8,40)DT*I,W(I),H1(I)*R,V1(I)*R
	ENDDO
	STOP
40	FORMAT(4(E12.6,1X))
70	CALL SUBP
	CALL SUBM
	ALENDA=12.0*EDA
	SUM1=ALENDA*S*SUM1
	WRITE(8,"('坐标X 压力P')")
	DO I=1,N
	WRITE(8,40)X(I),P(I)
	ENDDO
	WRITE(9,*)'承载力W'
	WRITE(9,*)SUM1     
	CONTAINS
	SUBROUTINE SUBP
	DO I=1,N
	PD(I)=P(I)
	ENDDO
	IK=0
	TEMP=DX*DX
	H=H0*H0*H0     
20	C1=0.0
	DO I=2,N1
    TEMP1=(X(I)+DX)/(DX+2.0*X(I))
	TEMP0=X(I)/(DX+2.0*X(I))
	P(I)=TEMP1*P(I+1)+P(I-1)*TEMP0-(TEMP0*V*TEMP)/H
	C1=C1+ABS(P(I)-PD(I))
	PD(I)=P(I)
	ENDDO
	P(1)=P(2)
	P(N)=0.0
	PD(1)=PD(2)
	PD(N)=0.0
	IK=IK+1	
	IF(C1.GT.1.E-20.AND.IK.LE.20000)GOTO 20
	RETURN
	END SUBROUTINE SUBP
	SUBROUTINE SUBM
	SUM1=0.0
	DO I=1,N
	SUM1=SUM1+P(I)*X(I)*DX*PI2
    ENDDO
    RETURN 
	END SUBROUTINE SUBM
	END
