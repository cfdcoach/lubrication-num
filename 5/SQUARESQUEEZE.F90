	PROGRAM SQUARESQUEEZE
	DIMENSION X(121),Y(121),P(121,121),PD(121,121),H1(51),T(51),V1(51),W(51)
	DATA N,N1,N2,N3/121,120,51,50/
	DATA AL,B,EDA,PI/30.0,24.0,0.02,3.14159265/
	OPEN(8,FILE='PRESSURE.DAT',STATUS='UNKNOWN')
	OPEN(9,FILE='RESULT.DAT',STATUS='UNKNOWN')
	OPEN(10,FILE='LOAD.DAT',STATUS='UNKNOWN')
	WRITE(*,*)'LD=0 挤压过程计算；LD=1 挤压瞬时压力分布与载荷计算?'
	READ(*,*)LD
	IF(LD.EQ.1)THEN
	H0=0.641032E-02
	V=-0.194504E-01
	ELSE
	SUM0=1000.0
	H0=0.05
	ENDIF
	DX=1.0/N1
	DY=1.0/N1
	PI2=2.0*PI
	RATIO=AL/B
	ALF=RATIO**2
	V=V/AL
	H0=H0/AL
	S=AL*B/1000000.0
	DO I=1,N
	X(I)=-0.5+(I-1)*DX	
	Y(I)=-0.5+(I-1)*DY	
	ENDDO		
	DO I=1,N
	DO J=1,N
	P(I,J)=0.0
	ENDDO
	ENDDO
	IF(LD.EQ.1)THEN
	SUM0=0.0
	GOTO 70
	ELSE
	GOTO 50
	ENDIF
50	U=PI2/50.0
	DO I=1,N2
	W(I)=SUM0*(1.0+SIN(U*(I-1)))
	ENDDO
	H1(1)=H0
	DO K=1,N3  
	V=-1.0
	V=V/AL		
	DT=0.001
	CALL SUBP 
	CALL SUBM   
	ALENDA=12.0*EDA
	SUM1=ALENDA*S*SUM1
	V1(K)=W(K)*V/SUM1
	H1(K+1)=H1(K)+V1(K)*DT 
	WRITE(*,*)SUM1,V1(K),H1(K+1)
	H0=H1(K+1)
	ENDDO
	H0=H1(N2)
	V=-1.0
	V=V/AL	
	CALL SUBP  
	CALL SUBM  
	ALENDA=12.0*EDA
	SUM1=ALENDA*S*SUM1
	V1(N2)=W(N2)*V/SUM1
	WRITE(9,"('时间T 载荷W 膜厚H 挤压速度V')")
	DO I=1,N2
	WRITE(9,40)DT*I,W(I),H1(I)*AL,V1(I)*AL
	ENDDO
	STOP
40	FORMAT(122(E12.6,1X))    
70	CALL SUBP
	CALL SUBM
	ALENDA=12.0*EDA
	SUM1=ALENDA*S*SUM1     
	WRITE(8,40)Y(1),(Y(I),I=1,N) 
	DO I=1,N
	WRITE(8,40)X(I),(P(I,J),J=1,N)
	ENDDO
	WRITE(10,*)'承载力W'
	WRITE(10,*)SUM1     
	CONTAINS
	SUBROUTINE SUBP
	DO I=1,N
	DO J=1,N
	PD(I,J)=P(I,J)
	ENDDO
	ENDDO
	IK=0
	TEMP=DX**2
	H=H0**3	
20	C1=0.0
	DO I=2,N1
	I1=I-1
	I2=I+1	
	DO J=2,N1
	P(I,J)=((P(I2,J)+P(I1,J)+ALF*P(I,J+1)+ALF*P(I,J-1)-TEMP*V/H))/(2+2*ALF)
	C1=C1+ABS(P(I,J)-PD(I,J))
	PD(I,J)=P(I,J)
	ENDDO
	ENDDO
	IK=IK+1	
	IF(C1.GT.1.E-20.AND.IK.LE.20000)GOTO 20
	RETURN
	END SUBROUTINE SUBP
	SUBROUTINE SUBM  
	SUM2=0.0
	DO I=1,N
	DO J=1,N
	SUM2=SUM2+P(I,J)*DX*DY
    ENDDO
	ENDDO
    SUM1=SUM2
    RETURN 
	END SUBROUTINE SUBM
	END
