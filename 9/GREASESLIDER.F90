	PROGRAM GREASESLIDER
	DIMENSION X(121),H(121),P(121)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX,P0
	DATA N,U,X1,X2,H1,H2,EDA,AL/121,1.0,0.0,1.0,1.0,0.5,0.08,0.01/ 
	OPEN(7,FILE='GREASESLIDER.DAT',STATUS='UNKNOWN')
	WRITE(*,*)'n=?'
	READ(*,*)AN
	P0=2.0*EDA*AL*(U*(4.0+2.0/AN)/H2**2)**AN
	CALL SUBH(N,X,H)
	H0=0.5*(H(1)+H(N))
	DH=1.E-4*H0
	CALL SUBP(N,AN,H0,DH,X,H,P)
	CALL OUTPUT(KG,N,AN,X,H,P)
	STOP
	END
	SUBROUTINE SUBH(N,X,H)
	DIMENSION X(N),H(N)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX,P0
	DX=1./(N-1.0)
	DO I=1,N
	X(I)=X1-(I-1)*DX*(X1-X2)
	H(I)=H1/H2-(H1/H2-1.0)*X(I)
	ENDDO
	RETURN
	END
	SUBROUTINE SUBP(N,AN,H0,DH,X,H,P)
	DIMENSION X(N),H(N),P(N)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX,P0
	P(1)=0.0
10	DO I=2,N
	IF(H(I)-H0.GT.0.0)THEN
	A=H(I)-H0
	P(I)=P(I-1)+A**AN*DX/H(I)**(2.0*AN+1.0)
	ENDIF
	IF(H(I)-H0.LT.0.0)THEN
	A=H0-H(I)
	P(I)=P(I-1)-A**AN*DX/H(I)**(2.0*AN+1.0)
	ENDIF
	IF(H(I)-H0.EQ.0.0)P(I)=P(I-1)
	ENDDO
	IF(ABS(P(N)).GT.1.E-6)THEN
	IF(P(N).GT.0.0)THEN
	H0=H0+DH
	IF(KG.EQ.0)DH=DH/2.0
	KG=1
	ENDIF
	IF(P(N).LT.0.0)THEN
	H0=H0-DH
	IF(KG.EQ.1)DH=DH/2.0
	KG=0
	ENDIF
	WRITE(*,*)P(N)
	GOTO 10
	ENDIF
	RETURN
	END
	SUBROUTINE OUTPUT(KG,N,AN,X,H,P)
	DIMENSION X(N),H(N),P(N)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX,P0
	X0=0.0
	ALOAD=0.0
	DO I=1,N
	ALOAD=ALOAD+P(I)
	X0=X0+P(I)*X(I)
	ENDDO
	X0=X0*AL
	ALOAD=P0*AL*ALOAD*DX
	WRITE(*,*)AN,ALOAD,X0
	DO I=1,N
	WRITE(7,40) X(I),H(I),P(I)
	END DO
40	FORMAT(1X,3(E12.6,1X))
	RETURN
	END