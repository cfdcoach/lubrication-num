	PROGRAM DYNAMICBEARING
	REAL*4,ALLOCATABLE::DEE(:),DFF(:),VDDET(:),VDECC(:)
	DIMENSION X(121),Y(121),H(121,121),P1(121,121),PD(121,121),P2(121,121),PE(121,121)
	DIMENSION P(121,121),P3(121,121),QQ(41),DE(121),DF(121)
	DIMENSION HXY(121,121),HXF(121,121),HXB(121,121),HYF(121,121),HYB(121,121)
	DIMENSION AM(11,41),AM1(11,41),AM2(11,41),S(11,41),S1(11,41),S2(11,41),S3(11),S4(11),EPS(11)
	CHARACTER*1 O,O1,O2
	DATA N,B,D,DD,EDA,PI/121,0.024,0.03,0.02992,0.02,3.14159265/,O1,O2/1HY,1Hy/
	DATA DDET,DECC,DET,EPSON,RI,SUM,WB,WJ,WL/0.104717E+03,0.927026E-03,30.0,0.656199E+00,40.0,1500.0,2000.0,3000.0,1000.0/
	DATA EPS/0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,0.995/
	OPEN(8,FILE='PRESSURE.DAT',STATUS='UNKNOWN')
	OPEN(9,FILE='FILM.DAT',STATUS='UNKNOWN')
	OPEN(13,FILE='RESULT.DAT',STATUS='UNKNOWN')
	OPEN(14,FILE='ANGLE.DAT',STATUS='UNKNOWN')
	OPEN(15,FILE='TRACE.DAT',STATUS='UNKNOWN')
	OPEN(16,FILE='LOAD.DAT',STATUS='UNKNOWN')
	OPEN(17,FILE='VELOCITY.DAT',STATUS='UNKNOWN')
	WRITE(*,*)'压力计算:LD=1; 旋转载荷:LD=-1;突加载荷LD=0. 请输入LD='
	READ(*,*)LD
	WRITE(*,*)'是否按给定数据演示算例 (输入Y or N)?'
	READ(*,'(A)')O
	IF(O.EQ.O1.OR.O.EQ.O2)GOTO 10
	WRITE(*,*)'请输入轴承角速度:'
	READ(*,*)WB
	WRITE(*,*)'请输入轴颈角速度:'
	READ(*,*)WJ
	IF(LD.EQ.-1)THEN
	WRITE(*,*)'请输入外载荷和载荷角速度'                              
	READ(*,*)SUM,WL
	WRITE(*,*)'请输入轴心的初始位置ε,δ'
	READ(*,*)EPSON,DET
	ENDIF
	IF(LD.EQ.1)THEN
	WRITE(*,*)'请输入偏心率、轴心运动参数DDET,DECC'
	READ(*,*)EPSON,DDET,DECC
	ENDIF
	IF(LD.EQ.0)THEN
	WRITE(*,*)'请输入轴心的初始位置ε,δ'
	READ(*,*)EPSON,DET
	WRITE(*,*)'请输入突加外载荷和载荷方向角' 
	READ(*,*)SUM,RI
	ENDIF
10	N1=N-1
	N2=N1/2+1		
	PI2=2.0*PI
	R=D/2	
	C=(D-DD)/2.0
	PESAI=(D-DD)/D
	DX=PI2/N1
	DY=1.0/N1
	RATIO=PI2*R/B
	ALFA=RATIO**2
	WB=WB*PI2/60.0
	WJ=WJ*PI2/60.0
 	WL=WL*PI2/60.0
	DET=DET*PI/180.0
	RI=RI*PI/180.0
	W=WB+WJ-2.0*DDET
	CC=EPSON
	BB=DET
	AA=RI
	DXDY=PI2/(N1*N1)			
	DO I=1,N
	X(I)=(I-1)*DX
	Y(I)=-0.5+(I-1)*DY	
	ENDDO		
	DO I=1,N
	DO J=1,N
	P(I,J)=0.0
	P1(I,J)=0.0
	P2(I,J)=0.0
	P3(I,J)=0.0
	ENDDO
	ENDDO
	IF(LD.EQ.1)THEN
	SUM=0.0
	GOTO 70
	ENDIF
	DO K=1,11
	WRITE(*,*)K
	EPSON=EPS(K)
	WRITE(*,*)EPSON
	CALL SUBH   
	CALL SUBP1
	CALL SUBP2 
	DO L=1,41
	QQ(L)=-20.0+L-1
	DO I=1,N
	DO J=1,N
	P3(I,J)=P1(I,J)+QQ(L)*P2(I,J)
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO 
	CALL SUBM		
	IF(PX.GT.0.0)THEN
	AI=180.0-180.0*ATAN(PY/PX)/PI
	ELSE
	AI=-180.0*ATAN(PY/PX)/PI
	ENDIF
	AM1(K,L)=AI
	S1(K,L)=SUM1		
	DO I=1,N
	DO J=1,N
	P3(I,J)=-(P1(I,J)+QQ(L)*P2(I,J))
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0 
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO
	CALL SUBM  	     
	IF(PX.GT.0.0)THEN
	AI=180.0-180.0*ATAN(PY/PX)/PI
	ELSE
	AI=360.0-180.0*ATAN(PY/PX)/PI
	ENDIF
	AM2(K,L)=AI
	S2(K,L)=SUM1
	DO I=1,N
	DO J=1,N
	P3(I,J)=P2(I,J)
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO
	CALL SUBM
	S3(K)=SUM1
	DO I=1,N
	DO J=1,N
	P3(I,J)=-P2(I,J)
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)		
	ENDDO
	ENDDO
	CALL SUBM
	S4(K)=SUM1
	ENDDO
	ENDDO
100	FORMAT(122(E12.6,1X))
	WRITE(14,100)AM1,AM2
	WRITE(16,100)S1,S2,S3,S4			
	DO L=1,41
	QQ(L)=-20.0+L-1
	ENDDO
	EPSON=CC
	DET=BB
	DDT=PI/(WJ*60.0)
	DE(1)=CC
	DF(1)=BB        
	KK=1
30	DO II=1,120
	KK=KK+1
	IF(WL.EQ.0.0)THEN
	RI=AA
	ELSE
	RI=(KK-2)*WL*DDT
	ENDIF
	RI=MOD(RI,PI2)
	ZZ=DET
	DET=MOD(ZZ,PI2)   
	RI=DET-RI
	AII=ABS(180.0-180.0*RI/PI)       
	IF(EPSON.LE.0.05)THEN
	K=1
	AKL=0.0
	ENDIF
	IF(EPSON.GE.0.995)THEN
	K=11
	AKL=0.0
	ENDIF
	IF((EPSON.GT.0.05).AND.(EPSON.LT.0.995))THEN
	AKL=10*EPSON+1	
	K=FLOOR(AKL)
	AKL=ABS(K-AKL)
	ENDIF
	IF(ABS(AII-180.0).LE.0.05)THEN  	 
	CALL SUBSUM1
	DECC=(SUM*PESAI**2)/(12.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ)	  
	ENDIF	
	IF((ABS(AII).LE.0.05).OR.(ABS(AII-360.0).LE.0.05))THEN
	CALL SUBSUM1
	DECC=(-SUM*PESAI**2)/(12.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ)
	ENDIF
	IF((AII.GT.0.05).AND.(AII.LT.179.95))THEN
	DO I=1,11
	DO J=1,41
	AM(I,J)=AM1(I,J)
	ENDDO
	ENDDO
	CALL SUBQ
	IF(ABS(Q).LE.25.0)THEN
	DO I=1,11
	DO J=1,41
	S(I,J)=S1(I,J)
	ENDDO
	ENDDO
	ENDIF
	CALL SUBSUM1
	IF(Q.GT.25.0)THEN
	DECC=(SUM*PESAI**2)/(12.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ)
	ENDIF
	IF(Q.LT.-25.0)THEN
	DECC=(-SUM*PESAI**2)/(12.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ)
	ENDIF
	IF(ABS(Q).LE.25.0)THEN
	W=(SUM*PESAI**2)/(6.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ-W)
	DECC=0.5*Q*W
	ENDIF
	ENDIF
	IF((AII.GT.180.05).AND.(AII.LT.359.95))THEN
	DO I=1,11
	DO J=1,41
	AM(I,J)=AM2(I,J)
	ENDDO
	ENDDO
	CALL SUBQ
	IF(ABS(Q).LE.25.0)THEN
	DO I=1,11
	DO J=1,41
	S(I,J)=S2(I,J)
	ENDDO
	ENDDO
	ENDIF
	CALL SUBSUM1
	IF(Q.GT.25.0)THEN
	DECC=(-SUM*PESAI**2)/(12.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ)
	ENDIF
	IF(Q.LT.-25.0)THEN
	DECC=(SUM*PESAI**2)/(12.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ)
	ENDIF
	IF(ABS(Q).LE.25.0)THEN
	W=(SUM*PESAI**2)/(6.0*EDA*SUM1*B*D)
	DDET=0.5*(WB+WJ+W)
	DECC=-0.5*Q*W
	ENDIF
	ENDIF
	EPSON=EPSON+DECC*DDT
    DET=ZZ+DDET*DDT    
	IF(EPSON.LT.0.0)THEN
	EPSON=-EPSON
	DET=DET+PI
	ENDIF
	DE(II+1)=EPSON
	DF(II+1)=DET			 
	ALLOCATE(DEE(KK))	   
	ALLOCATE(DFF(KK))	  
	ALLOCATE(VDDET(KK-1))	   	
	ALLOCATE(VDECC(KK-1)) 
	IF(KK.EQ.2)THEN
	DEE(1)=DE(1)
	DFF(1)=DF(1)
	DEE(KK)=DE(II+1)
	DFF(KK)=DF(II+1)
	WRITE(15,"('偏心率ε            固定轴X与最大膜厚的正角度δ')")
	WRITE(15,100)DEE(1),DFF(1)*180.0/PI
	WRITE(15,100)DEE(KK),DFF(KK)*180.0/PI
	ELSE
	DEE(KK)=DE(II+1)
	DFF(KK)=DF(II+1)
	WRITE(15,100)DEE(KK),DFF(KK)*180.0/PI
	ENDIF
	VDDET(KK-1)=DDET	  
	VDECC(KK-1)=DECC
	IF(KK.EQ.2)THEN
	WRITE(17,"('偏心率ε           dδ/dt              dε/dt')")
	WRITE(17,100)DEE(1),VDDET(1),VDECC(1)
	ELSE
	WRITE(17,100)DEE(KK),VDDET(KK-1),VDECC(KK-1)
	ENDIF
	IF(II.EQ.120)THEN
	ANBA=DEE(KK)
	CBA=DFF(KK)	
	ENDIF   
	XX=MOD(CBA,PI2)	
	Y1=ABS(ANBA-CC)
	Y2=ABS(XX-BB)
	AT=CBA
	DEALLOCATE(DEE)
	DEALLOCATE(DFF)
	DEALLOCATE(VDDET)
	DEALLOCATE(VDECC) 	   
	IF(WL.EQ.0.0)THEN
	AB=ABS(DE(II+1)-DE(II))
	AC=ABS(DF(II+1)-DF(II))
	IF((AB.EQ.0.0).AND.(AC.EQ.0.0))THEN
	WRITE(*,*)'End of TRACE CALCULATION'
	STOP
	ENDIF
	ENDIF 	 
	IF((Y1.LE.0.001).AND.(Y2.LE.0.1))EXIT
	ENDDO 	
	IF((KK.GE.1081).AND.(AT.GE.2*PI2))THEN
	WRITE(*,*)'End of TRACE CALCULATION'
	STOP	  	 
	ENDIF     
	EPSON=ANBA
	DET=CBA
	IF((Y1.GT.0.001).OR.(Y2.GT.0.1).OR.(AT.LE.2*PI2))GOTO 30 
70	CALL SUBH   
	CALL SUBP1
	CALL SUBP2
	IF(W.NE.0)THEN
	Q=2*DECC/W
	IF(W.GT.0.0)THEN
	DO I=1,N
	DO J=1,N
	P3(I,J)=P1(I,J)+Q*P2(I,J)
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO 
	ELSE
	DO I=1,N
	DO J=1,N
	P3(I,J)=-(P1(I,J)+Q*P2(I,J))
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO
	ENDIF		        
	CALL SUBMAX
	CALL SUBM     
	E=EPSON*C*1.0E3
	HMIN=C*(1.0-EPSON)
	ALENDA=(6.0*EDA*W)/(PESAI**2)	
	SUM1=ABS(ALENDA)*B*D*SUM1
	IF(W.GT.0.0)THEN
	IF(PX.GT.0.0)THEN
	AI=180.0-180.0*ATAN(PY/PX)/PI
	ELSE
	AI=-180.0*ATAN(PY/PX)/PI
	ENDIF
	ENDIF
	IF(W.LT.0.0)THEN
	IF(PX.GT.0.0)THEN
	AI=180.0-180.0*ATAN(PY/PX)/PI
	ELSE
	AI=360.0-180.0*ATAN(PY/PX)/PI
	ENDIF
	ENDIF
	ENDIF
	IF(W.EQ.0)THEN
	IF(DECC.GT.0.0)THEN
	DO I=1,N
	DO J=1,N
	P3(I,J)=P2(I,J)
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO
	ELSE
	DO I=1,N
	DO J=1,N
	P3(I,J)=-P2(I,J)
	IF(P3(I,J).LE.0.0)P3(I,J)=0.0
	P(I,J)=P3(I,J)
	ENDDO
	ENDDO
	ENDIF
	CALL SUBMAX
	CALL SUBM    	 
	E=EPSON*C*1.0E3
	HMIN=C*(1.0-EPSON)
	AI=180.0*ATAN(PY/PX)/PI
	ALENDA=(12.0*EDA*DECC)/(PESAI**2)      
	SUM1=ABS(ALENDA)*B*D*SUM1		
	ENDIF	 	 
	WRITE(8,40)Y(1),(Y(I),I=1,N)
	DO I=1,N
	WRITE(8,40)X(I)*180/PI,(P(I,J)*ALENDA,J=1,N)
	ENDDO
	WRITE(9,40)Y(1),(Y(I),I=1,N)
	DO I=1,N
	WRITE(9,40)X(I)*180/PI,(H(I,J)*C,J=1,N)
	ENDDO
40	FORMAT(122(E12.6,1X))
	IF(LL.EQ.0)	WRITE(13,*)'ε e ψmax,Pmax W,ψ'
	LL=LL+1
	WRITE(13,*)EPSON,E,AIMAX,PMAX,SUM1,AI
	CONTAINS
	SUBROUTINE SUBH
	DO I=1,N
	DO J=1,N
	H(I,J)=1.0+EPSON*COS((I-1)*DX)
	ENDDO	
	ENDDO
	DO I=1,N
	I1=I-1
	I2=I+1
	IF(I.EQ.1)I1=N1
	IF(I.EQ.N)I2=2
	DO J=2,N1
	HXF(I,J)=(0.5*(H(I2,J)+H(I,J)))**3
	HXB(I,J)=(0.5*(H(I1,J)+H(I,J)))**3
	HYF(I,J)=ALFA*(0.5*(H(I,J+1)+H(I,J)))**3
	HYB(I,J)=ALFA*(0.5*(H(I,J-1)+H(I,J)))**3
	HXY(I,J)=1.0/(HXF(I,J)+HXB(I,J)+HYF(I,J)+HYB(I,J))
	ENDDO
	ENDDO        
	RETURN
	END SUBROUTINE SUBH
	SUBROUTINE SUBP1
	DO I=1,N
	DO J=1,N
	PD(I,J)=P1(I,J)
	ENDDO
	ENDDO
	IK=0
	TEMP0=DX**2*EPSON	  	
10	C1=0.0
	DO I=1,N1
	I1=I-1
	I2=I+1
	IF(I1.EQ.0)I1=N1
	IF(I2.EQ.N)I2=1
	DO J=2,N1
	P1(I,J)=(HXF(I,J)*P1(I2,J)+HXB(I,J)*P1(I1,J)+HYF(I,J)*P1(I,J+1)+HYB(I,J)*P1(I,J-1)+TEMP0*SIN((I-1)*DX))*HXY(I,J)
	C1=C1+ABS(P1(I,J)-PD(I,J))
	PD(I,J)=P1(I,J)
	ENDDO
	ENDDO
	DO J=2,N1
	P1(N,J)=P1(1,J)
	PD(N,J)=PD(1,J)
	ENDDO
	IK=IK+1	
	IF(C1.GT.1.E-20.AND.IK.LE.20000)GOTO 10
 	RETURN
	END SUBROUTINE SUBP1
    SUBROUTINE SUBP2
	DO I=1,N
	DO J=1,N
	PE(I,J)=P2(I,J)
	ENDDO
	ENDDO
	IK=0
	TEMP1=DX**2	
20	C1=0.0
	DO I=1,N1
	I1=I-1
	I2=I+1
	IF(I1.EQ.0)I1=N1
	IF(I2.EQ.N)I2=1
	DO J=2,N1
	P2(I,J)=(HXF(I,J)*P2(I2,J)+HXB(I,J)*P2(I1,J)+HYF(I,J)*P2(I,J+1)+HYB(I,J)*P2(I,J-1)-TEMP1*COS((I-1)*DX))*HXY(I,J)
	C1=C1+ABS(P2(I,J)-PE(I,J))
	PE(I,J)=P2(I,J)
	ENDDO
	ENDDO
	DO J=2,N1
	P2(N,J)=P2(1,J)
	PE(N,J)=PE(1,J)
	ENDDO
	IK=IK+1	
	IF(C1.GT.1.E-20.AND.IK.LE.20000)GOTO 20
 	RETURN
	END SUBROUTINE SUBP2
	SUBROUTINE SUBMAX 
	TEMP0=PI2/N1
	PMAX=P(1,1)
	DO I=1,N
	DO J=1,N
	IF(P(I,J).GE.PMAX)THEN
	PMAX=P(I,J)
	I_MAX=I
	J_MAX=J
	ENDIF
	ENDDO
	ENDDO
	AIMAX=((I_MAX-1)*TEMP0*180)/PI
	RETURN
	END  SUBROUTINE SUBMAX
	SUBROUTINE SUBM
	PX=0.0
	PY=0.0
	TEMP=PI/60.0
	DO I=1,N
	AI=(I-1)*TEMP
	DO J=1,N	
	PX=PX-P(I,J)*COS(AI)*DXDY
	PY=PY+P(I,J)*SIN(AI)*DXDY
	ENDDO
	ENDDO
	SUM1=SQRT(PX*PX+PY*PY)
	RETURN 
	END SUBROUTINE SUBM
	SUBROUTINE SUBQ
	Q=0.0
	QI1=0.0
	QI2=0.0
	IF(AII.LT.AM(K,1))THEN
	QI1=QQ(1)*(AII-AM(K,2))/(AM(K,1)-AM(K,2))+QQ(2)*(AII-AM(K,1))/(AM(K,2)-AM(K,1))
	ENDIF
	IF(AII.GT.AM(K,41))THEN
	QI1=QQ(41)*(AII-AM(K,40))/(AM(K,41)-AM(K,40))+QQ(40)*(AII-AM(K,41))/(AM(K,40)-AM(K,41))
	ENDIF
	IF((AII.GT.AM(K,1)).AND.(AII.LT.AM(K,41)))THEN
	DO L=1,40
	IF((AII.GE.AM(K,L)).AND.(AII.LE.AM(K,L+1)))THEN
	J=L
	ENDIF
	ENDDO
	QI1=QQ(J)*(AII-AM(K,J+1))/(AM(K,J)-AM(K,J+1))+QQ(J+1)*(AII-AM(K,J))/(AM(K,J+1)-AM(K,J))
	ENDIF
	IF(AKL.NE.0.0)THEN 
	IF(AII.LT.AM(K+1,1))THEN
	QI2=QQ(1)*(AII-AM(K+1,2))/(AM(K+1,1)-AM(K+1,2))+QQ(2)*(AII-AM(K+1,1))/(AM(K+1,2)-AM(K+1,1))
	ENDIF
	IF(AII.GT.AM(K+1,41))THEN
	QI2=QQ(41)*(AII-AM(K+1,40))/(AM(K+1,41)-AM(K+1,40))+QQ(40)*(AII-AM(K+1,41))/(AM(K+1,40)-AM(K+1,41))
	ENDIF
	IF((AII.GT.AM(K+1,1)).AND.(AII.LT.AM(K+1,41)))THEN
	DO L=1,40
	IF((AII.GE.AM(K+1,L)).AND.(AII.LE.AM(K+1,L+1)))THEN
	I=L
	ENDIF
	ENDDO
	QI2=QQ(I)*(AII-AM(K+1,I+1))/(AM(K+1,I)-AM(K+1,I+1))+QQ(I+1)*(AII-AM(K+1,I))/(AM(K+1,I+1)-AM(K+1,I))
	ENDIF
	Q=-QI1*(EPSON-0.1*(K+1))*10.0+QI2*(EPSON-0.1*K)*10.0
	ENDIF    
	IF(AKL.EQ.0.0)THEN
	Q=QI1
	ENDIF
	RETURN
	END SUBROUTINE SUBQ
	SUBROUTINE SUBSUM1
	SUM1=0.0 
	SUMY1=0.0
	SUMY2=0.0
	IF(ABS(AII).LE.0.05)THEN
	SUM1=S4(K)*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+S4(K+1)*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))    
	ENDIF
	IF(ABS(AII-180.0).LE.0.05)THEN
	SUM1=S3(K)*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+S3(K+1)*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))
	ENDIF
	IF((AII.GT.0.05).AND.(AII.LT.179.95))THEN
	IF(Q.LT.-25.0)THEN
	SUM1=S4(K)*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+S4(K+1)*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))    
	ENDIF 
	IF(Q.GT.25.0)THEN
	SUM1=S3(K)*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+S3(K+1)*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))
	ENDIF
	ENDIF
	IF((AII.GT.180.05).AND.(AII.LT.359.95))THEN
	IF(Q.LT.-25.0)THEN
	SUM1=S3(K)*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+S3(K+1)*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))    
	ENDIF 
	IF(Q.GT.25.0)THEN
	SUM1=S4(K)*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+S4(K+1)*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))
	ENDIF
	ENDIF
	IF(ABS(Q).LE.25.0)THEN
	IF(Q.LT.-20.0)THEN
	SUMY1=S(K,1)*(Q-QQ(2))/(QQ(1)-QQ(2))+S(K,2)*(Q-QQ(1))/(QQ(2)-QQ(1))
	SUMY2=S(K+1,1)*(Q-QQ(2))/(QQ(1)-QQ(2))+S(K+1,2)*(Q-QQ(1))/(QQ(2)-QQ(1))
	SUM1=SUMY1*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+SUMY2*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))   
	ENDIF
	IF(Q.GT.20.0)THEN
	SUMY1=S(K,41)*(Q-QQ(40))/(QQ(41)-QQ(40))+S(K,40)*(Q-QQ(41))/(QQ(40)-QQ(41))
	SUMY2=S(K+1,41)*(Q-QQ(40))/(QQ(41)-QQ(40))+S(K+1,40)*(Q-QQ(41))/(QQ(40)-QQ(41))
	SUM1=SUMY1*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+SUMY2*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))   
	ENDIF
	IF((Q.GE.-20.0).AND.(Q.LE.20.0))THEN
	QZ=Q+21
	J=FLOOR(QZ)	          
	SUMY1=S(K,J+1)*(Q-QQ(J))/(QQ(J+1)-QQ(J))+S(K,J)*(Q-QQ(J+1))/(QQ(J)-QQ(J+1))
	SUMY2=S(K+1,J+1)*(Q-QQ(J))/(QQ(J+1)-QQ(J))+S(K+1,J)*(Q-QQ(J+1))/(QQ(J)-QQ(J+1))
	SUM1=SUMY1*(EPSON-EPS(K+1))/(EPS(K)-EPS(K+1))+SUMY2*(EPSON-EPS(K))/(EPS(K+1)-EPS(K))  
	ENDIF
	ENDIF
	RETURN
	END  SUBROUTINE SUBSUM1
	END