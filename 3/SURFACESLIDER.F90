	PROGRAM SURFACESLIDER
	DIMENSION X(121),Y(121),H(121,121),P(121,121)
	COMMON /COM1/DX,DY,ALFA,X1,X2,Y1,Y2,H1,H2,ALOAD,U,EDA,ALX,ALY,ALENDA
	DATA N,M,EDA,ALX,ALY,U,H1,H2,X1,X2,Y1,Y2/121,121,0.02,0.03,0.024,1.0,0.1,0.05,0.0,1.0,-0.5,0.5/
	OPEN(8,FILE='PRESSURE.DAT',STATUS='UNKNOWN')
	OPEN(9,FILE='FILM.DAT',STATUS='UNKNOWN')
	WRITE(*,*)'If KG=1: Plane surface; KG=2: Curve surface; Input KG='
	READ(*,*)KG
	CALL SUBH(KG,N,M,X,Y,H)
	CALL SUBP(N,M,X,Y,H,P)
	CALL OUTPUT(N,M,X,Y,H,P)
	STOP
	END
	SUBROUTINE SUBH(KG,N,M,X,Y,H)
	DIMENSION X(N),Y(N),H(N,M)
	COMMON /COM1/DX,DY,ALFA,X1,X2,Y1,Y2,H1,H2,ALOAD,U,EDA,ALX,ALY,ALENDA
	IF(KG.EQ.2)THEN
	X1=-1.0
	X2=1.0
	Y1=-1.0
	Y2=1.0
	ELSE
	KG=1
	ENDIF
	DX=1.0/(N-1.0)
	DY=1.0/(M-1.0)
	ALFA=(ALX/ALY)**2
	DO I=1,N
	X(I)=X1-(I-1)*DX*(X1-X2)
	ENDDO
	DO J=1,M
	IF(KG.EQ.1)Y(J)=-0.5-(J-1)*DY*(Y1-Y2)	
	IF(KG.EQ.2)Y(J)=-1.0-(J-1)*DY*(Y1-Y2)	
	ENDDO
	DO I=1,N
	DO J=1,M
	IF(KG.EQ.1)H(I,J)=H1/H2-X(I)*(H1/H2-1.0)
	IF(KG.EQ.2)H(I,J)=1.0+(X(I)*X(I)+Y(J)*Y(J))*(H1/H2-1.0)
	ENDDO	
	ENDDO
	RETURN
	END
	SUBROUTINE SUBP(N,M,X,Y,H,P)
	DIMENSION X(N),Y(N),H(N,M),P(N,M)
	COMMON /COM1/DX,DY,ALFA,X1,X2,Y1,Y2,H1,H2,ALOAD,U,EDA,ALX,ALY,ALENDA
	DO I=1,N
	P(I,1)=0.0
	P(I,N)=0.0
	ENDDO
	DO J=1,M
	P(1,J)=0.0
	P(N,J)=0.0
	ENDDO
	DO I=2,N-1
	DO J=2,M-1
	P(I,J)=0.05
	ENDDO
	ENDDO
	IK=0
10	C1=0.0
	ALOAD=0.0
	DO I=2,N-1
	I1=I-1
	I2=I+1
	DO J=2,M-1
	J1=J-1
	J2=J+1
	PD=P(I,J)
	A1=(0.5*(H(I2,J)+H(I,J)))**3
	A2=(0.5*(H(I,J)+H(I1,J)))**3
	A3=ALFA*(0.5*(H(I,J2)+H(I,J)))**3
	A4=ALFA*(0.5*(H(I,J)+H(I,J1)))**3
	P(I,J)=(-0.5*DX*(H(I2,J)-H(I1,J))+A1*P(I2,J)+A2*P(I1,J)+A3*P(I,J2)+A4*P(I,J1))/(A1+A2+A3+A4)
	P(I,J)=0.5*PD+0.5*P(I,J)
	IF(P(I,J).LT.0.0)P(I,J)=0.0
	C1=C1+ABS(P(I,J)-PD)
	ALOAD=ALOAD+P(I,J)
	ENDDO
	ENDDO
	IK=IK+1
	C1=C1/ALOAD
	WRITE(*,*)IK,C1,ALOAD
	IF(C1.GT.1.E-7)GOTO 10
	RETURN
	END
	SUBROUTINE OUTPUT(N,M,X,Y,H,P)
	DIMENSION X(N),Y(M),H(N,M),P(N,M)
	COMMON /COM1/DX,DY,ALFA,X1,X2,Y1,Y2,H1,H2,ALOAD,U,EDA,ALX,ALY,ALENDA
	ALENDA=6.0*U*EDA*ALX/H2**2
	ALOAD=ALOAD*ALENDA*DX*DY*ALX*ALY/(N-1.0)/(M-1.0)
	WRITE(8,40)Y(1),(Y(J),J=1,M)
	DO I=1,N
	WRITE(8,40)X(I),(P(I,J),J=1,M)
	ENDDO
	WRITE(9,40)Y(1),(Y(J),J=1,M)
	DO I=1,N
	WRITE(9,40)X(I),(H(I,J),J=1,M)
	ENDDO
40	FORMAT(122(E12.6,1X))
	STOP
	END
