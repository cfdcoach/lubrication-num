	PROGRAM SLIDER
	DIMENSION X(121),H(121),P(121)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX
	DATA N,U,X1,X2,H1,H2,EDA,AL/121,1.0,0.0,1.0,1.0,0.5,0.02,0.01/ 
	OPEN(7,FILE='SLIDER.DAT',STATUS='UNKNOWN')
	WRITE(*,*)'If KG=1: Straight slider; KG=2: Curve slider; Input KG='
	READ(*,*)KG
	IF(KG.EQ.2)THEN
	X1=-1.0
	X2=1.0
	ELSE
	KG=1
	ENDIF
	CALL SUBH(KG,N,X,H)
	CALL SUBP(N,X,H,P)
	CALL OUTPUT(KG,N,X,H,P)
	STOP
	END
	SUBROUTINE OUTPUT(KG,N,X,H,P)
	DIMENSION X(N),H(N),P(N)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX
	X0=0.0
	DO I=1,N
	X0=X0+P(I)*X(I)
	ENDDO
	X0=X0*AL
	ALOAD=ALOAD*DX*AL*6.0*U*EDA*AL/H2**2
	WRITE(*,*)N,ALOAD,X0
	DO I=1,N
	IF(KG.EQ.1)THEN
	P0=-(-1.0/(H(I)*H2)+H1*H2/(H1+H2)/(H2*H(I))**2+1.0/(H1+H2))/(H1/H2-1.0)*H2
	WRITE(7,40) X(I),H(I),P(I),P0
	ELSE
	WRITE(7,40) X(I),H(I),P(I)
	ENDIF
	END DO
40	FORMAT(1X,4(E12.6,1X))
	RETURN
	END
	SUBROUTINE SUBH(KG,N,X,H)
	DIMENSION X(N),H(N)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX
	DX=1./(N-1.0)
	DO I=1,N
	IF(KG.EQ.1) THEN
	X(I)=X1-(I-1)*DX*(X1-X2)
	H(I)=H1/H2-(H1/H2-1.0)*X(I)
	ELSE
	X(I)=X1-(I-1)*DX*(X1-X2)
	H(I)=1.0+(H1/H2-1.0)*X(I)*X(I)
	ENDIF
	ENDDO
	RETURN
	END
	SUBROUTINE SUBP(N,X,H,P)
	DIMENSION X(N),H(N),P(N)
	COMMON /COM1/X1,X2,H1,H2,U,EDA,AL,ALOAD,DX
	DO I=2,N-1
	P(I)=0.5
	ENDDO
	P(1)=0.0
	P(N)=0.0
	IK=0
10	C1=0.0
	ALOAD=0.0
	DO I=2,N-1
	A1=(0.5*(H(I+1)+H(I)))**3
	A2=(0.5*(H(I)+H(I-1)))**3
	PD=P(I)
	P(I)=(-0.5*DX*(H(I+1)-H(I-1))+A1*P(I+1)+A2*P(I-1))/(A1+A2)
	P(I)=0.3*PD+0.7*P(I)
	IF(P(I).LT.0.0)P(I)=0.0
	C1=C1+ABS(P(I)-PD)
	ALOAD=ALOAD+P(I)
	ENDDO
	ERO=C1/ALOAD
	IK=IK+1	
	IF(ERO.GT.1.E-7)GOTO 10
	RETURN
	END
